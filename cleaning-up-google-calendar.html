<!DOCTYPE html>
<html lang="en"><head><meta charset="utf-8"/><meta charset="utf-8" content="text/html" http-equiv="Content-Type"/><meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible"/><link href="https://mastodon.online/@qrkourier" rel="me"/><title>Cleaning up Google Calendar</title><meta content="True" name="HandheldFriendly"/><meta content="width=device-width, initial-scale=1.0" name="viewport"/><meta content="origin" name="referrer"/><meta content="Pelican" name="generator"/><link href="./cleaning-up-google-calendar.html" rel="canonical"/><link href="https://www.qrk.us/feeds/all.atom.xml" rel="alternate" title="hella labs Full Atom Feed" type="application/atom+xml"/><link href="https://www.qrk.us/feeds/tech.atom.xml" rel="alternate" title="hella labs Categories Atom Feed" type="application/atom+xml"/><link href="././css/style.css" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Montserrat:400,300" rel="stylesheet" type="text/css"/><link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css"/><!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]--><script>var siteUrl='.';</script><script>var localTheme=localStorage.getItem('attila_theme');switch(localTheme){case'dark':document.documentElement.classList.add('theme-dark');break;case'light':document.documentElement.classList.add('theme-light');break;default:break;}</script><meta content="I stopped using Google Calendar as a primary calendar a few years ago, but I still had a lot of old events in there far into the future...." name="description"/><meta content="Kenneth" name="author"/><meta content="python" name="tags"/><meta content="googlecalendar" name="tags"/><meta content="googleapis" name="tags"/><meta content="hella labs" prefix="og: http://ogp.me/ns#" property="og:site_name"/><meta content="Cleaning up Google Calendar" prefix="og: http://ogp.me/ns#" property="og:title"/><meta content="I stopped using Google Calendar as a primary calendar a few years ago, but I still had a lot of old events in there far into the future...." prefix="og: http://ogp.me/ns#" property="og:description"/><meta content="en_US" prefix="og: http://ogp.me/ns#" property="og:locale"/><meta content="./cleaning-up-google-calendar.html" prefix="og: http://ogp.me/ns#" property="og:url"/><meta content="article" prefix="og: http://ogp.me/ns#" property="og:type"/><meta content="2023-12-17 21:09:59.111327+00:00" prefix="og: http://ogp.me/ns#" property="article:published_time"/><meta content="2023-12-17 21:09:59.111327+00:00" prefix="og: http://ogp.me/ns#" property="article:modified_time"/><meta content="./author/kenneth.html" prefix="og: http://ogp.me/ns#" property="article:author"/><meta content="Tech" prefix="og: http://ogp.me/ns#" property="article:section"/><meta content="python" prefix="og: http://ogp.me/ns#" property="article:tag"/><meta content="googlecalendar" prefix="og: http://ogp.me/ns#" property="article:tag"/><meta content="googleapis" prefix="og: http://ogp.me/ns#" property="article:tag"/><meta content="https://github.com/qrkourier/qrkourier.github.io/assets/1434400/e6b42272-75b0-4b3c-8ab8-2a23be94d45f" prefix="og: http://ogp.me/ns#" property="og:image"/><script type="application/ld+json">{"@context":"http://schema.org","@type":"Article","name":"Cleaning up Google Calendar","headline":"Cleaning up Google Calendar","datePublished":"2023-12-17 21:09:59.111327+00:00","dateModified":"2023-12-17 21:09:59.111327+00:00","author":{"@type":"Person","name":"Kenneth","url":"./author/kenneth.html"},"image":"././images/post-bg.jpg","url":"./cleaning-up-google-calendar.html","description":"I stopped using Google Calendar as a primary calendar a few years ago, but I still had a lot of old events in there far into the future...."}</script></head><body class="category-template"><div class="nav-header"><nav aria-label="Main" class="nav-wrapper"><ul><li role="presentation"><a href="./"><span>Contact</span></a></li><li role="presentation"><a href="./pages/projects.html"><span>Projects</span></a></li><li role="presentation"><a href="./pages/about.html"><span>About</span></a></li><li class="nav-tech active" role="presentation"><a href="./category/tech.html"><span>Tech</span></a></li></ul><ul class="nav-meta"><li class="nav-search" style="display: none;"><a title="Search"><i aria-hidden="true" class="icon icon-search"></i><span>Search</span></a></li></ul> </nav><div class="nav-wrapper-control"><div class="inner"><a class="nav-menu" role="button"><i aria-hidden="true" class="icon icon-menu"></i>Menu</a><a class="nav-search" role="button" style="display: none;" title="Search"><i aria-hidden="true" class="icon icon-search"></i></a></div></div></div><div aria-label="Close" class="nav-close" role="button"></div><section class="page-wrapper" id="wrapper"><div class="progress-container"><span class="progress-bar"></span></div><header class="post-header"><div class="inner"><span class="post-info"><span class="post-type">Article</span><span class="post-count">Tech</span></span><h1 class="post-title">Cleaning up Google Calendar</h1><div class="post-meta"><div class="post-meta-avatars"><figure class="post-meta-avatar avatar"><a class="author-avatar" href="./author/kenneth.html"><img alt="Kenneth Bingham" class="author-profile-image" src="https://github.com/qrkourier/qrkourier.github.io/assets/1434400/a8155877-b78a-4ba0-895f-9396777f8b82"/></a></figure></div><h4 class="post-meta-author"> Kenneth Bingham </h4><time datetime="Sun 17 December 2023">Sun 17 December 2023</time></div></div></header><main class="content" role="main"><article class="post"><div class="inner"><section class="post-content"><p>I stopped using Google Calendar as a primary calendar a few years ago, but I still had a lot of old events in there far into the future. I must have imported the lunar cycle at some point because most of them are named like "New moon" or "Full moon." I wanted to clean them out so I don't see duplicates in my main calendar when I'm subscribed to the Google Calendar for the sake of events that can only be shared there, but there's no way to do bulk operations with the app or website, so I modified the Google API Python quickstart for Calendar to do it for me.</p><p>The quickstart starts out by listing the next ten events, and authorizes the readonly scope for calendar events. I changed it to authorize the read/write scope, and to find a larger number events, filter for certain titles, and delete them.</p><h3 id="the-steps-i-took">The Steps I took</h3><ol><li>Completed the <a href="https://developers.google.com/calendar/quickstart/python">Python Quickstart</a> for the Google Calendar API, and saved the Python program so I could modify it.</li><li>In the Python program, changed the scope to <code>https://www.googleapis.com/auth/calendar.events</code> so I could delete events.</li><li>Downloaded the JSON credentials file and named it <code>credentials.json</code> in the same directory as the Python program.</li><li>Ran the Python program, which opened a browser window to authorize the app to access my calendar.</li></ol><h3 id="a-simple-python-program-to-delete-events-by-title">A Simple Python Program to Delete Events by Title</h3><div class="highlight"><pre><span></span><code><span class="c1"># Copyright 2018 Google LLC</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the "License");</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1">#     http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an "AS IS" BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>

<span class="c1"># [START calendar_quickstart]</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>

<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">os.path</span>

<span class="kn">from</span> <span class="nn">google.auth.transport.requests</span> <span class="kn">import</span> <span class="n">Request</span>
<span class="kn">from</span> <span class="nn">google.oauth2.credentials</span> <span class="kn">import</span> <span class="n">Credentials</span>
<span class="kn">from</span> <span class="nn">google_auth_oauthlib.flow</span> <span class="kn">import</span> <span class="n">InstalledAppFlow</span>
<span class="kn">from</span> <span class="nn">googleapiclient.discovery</span> <span class="kn">import</span> <span class="n">build</span>
<span class="kn">from</span> <span class="nn">googleapiclient.errors</span> <span class="kn">import</span> <span class="n">HttpError</span>

<span class="c1"># If modifying these scopes, delete the file token.json.</span>
<span class="n">SCOPES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">'https://www.googleapis.com/auth/calendar.events'</span><span class="p">]</span>


<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
<span class="w">    </span><span class="sd">"""Shows basic usage of the Google Calendar API.</span>
<span class="sd">    Prints the start and name of the next 10 events on the user's calendar.</span>
<span class="sd">    """</span>
    <span class="n">creds</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="c1"># The file token.json stores the user's access and refresh tokens, and is</span>
    <span class="c1"># created automatically when the authorization flow completes for the first</span>
    <span class="c1"># time.</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="s1">'token.json'</span><span class="p">):</span>
        <span class="n">creds</span> <span class="o">=</span> <span class="n">Credentials</span><span class="o">.</span><span class="n">from_authorized_user_file</span><span class="p">(</span><span class="s1">'token.json'</span><span class="p">,</span> <span class="n">SCOPES</span><span class="p">)</span>
    <span class="c1"># If there are no (valid) credentials available, let the user log in.</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">creds</span> <span class="ow">or</span> <span class="ow">not</span> <span class="n">creds</span><span class="o">.</span><span class="n">valid</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">creds</span> <span class="ow">and</span> <span class="n">creds</span><span class="o">.</span><span class="n">expired</span> <span class="ow">and</span> <span class="n">creds</span><span class="o">.</span><span class="n">refresh_token</span><span class="p">:</span>
            <span class="n">creds</span><span class="o">.</span><span class="n">refresh</span><span class="p">(</span><span class="n">Request</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flow</span> <span class="o">=</span> <span class="n">InstalledAppFlow</span><span class="o">.</span><span class="n">from_client_secrets_file</span><span class="p">(</span>
                <span class="s1">'credentials.json'</span><span class="p">,</span> <span class="n">SCOPES</span><span class="p">)</span>
            <span class="n">creds</span> <span class="o">=</span> <span class="n">flow</span><span class="o">.</span><span class="n">run_local_server</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
        <span class="c1"># Save the credentials for the next run</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s1">'token.json'</span><span class="p">,</span> <span class="s1">'w'</span><span class="p">)</span> <span class="k">as</span> <span class="n">token</span><span class="p">:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">creds</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>

    <span class="k">try</span><span class="p">:</span>
        <span class="n">service</span> <span class="o">=</span> <span class="n">build</span><span class="p">(</span><span class="s1">'calendar'</span><span class="p">,</span> <span class="s1">'v3'</span><span class="p">,</span> <span class="n">credentials</span><span class="o">=</span><span class="n">creds</span><span class="p">)</span>

        <span class="c1"># Call the Calendar API</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span><span class="o">.</span><span class="n">isoformat</span><span class="p">()</span> <span class="o">+</span> <span class="s1">'Z'</span>  <span class="c1"># 'Z' indicates UTC time</span>
        <span class="c1"># now = '2035-12-29T00:00:00Z'  # 'Z' indicates UTC time</span>
        <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">'Getting events named like "moon" from </span><span class="si">{</span><span class="n">now</span><span class="si">}</span><span class="s1">'</span><span class="p">)</span>
        <span class="n">events_result</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">events</span><span class="p">()</span><span class="o">.</span><span class="n">list</span><span class="p">(</span><span class="n">calendarId</span><span class="o">=</span><span class="s1">'primary'</span><span class="p">,</span> <span class="n">timeMin</span><span class="o">=</span><span class="n">now</span><span class="p">,</span>
                                              <span class="n">maxResults</span><span class="o">=</span><span class="mi">999</span><span class="p">,</span> <span class="n">singleEvents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                              <span class="n">orderBy</span><span class="o">=</span><span class="s1">'startTime'</span><span class="p">,</span> <span class="n">showDeleted</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
        <span class="n">events</span> <span class="o">=</span> <span class="n">events_result</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'items'</span><span class="p">,</span> <span class="p">[])</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">events</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">'No upcoming events found.'</span><span class="p">)</span>
            <span class="k">return</span>

        <span class="c1"># Prints the start and name of the next 10 events</span>
        <span class="k">for</span> <span class="n">event</span> <span class="ow">in</span> <span class="n">events</span><span class="p">:</span>
            <span class="n">title</span> <span class="o">=</span> <span class="n">event</span><span class="p">[</span><span class="s1">'summary'</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">title</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'New moon'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">title</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'Full moon'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">or</span> <span class="n">title</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">'Blue moon'</span><span class="p">)</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Deleting </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">) with status </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="s1">'status'</span><span class="p">]</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="s1">'start'</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'dateTime'</span><span class="p">,</span><span class="w"> </span><span class="n">event</span><span class="p">[</span><span class="s1">'start'</span><span class="p">]</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">'date'</span><span class="p">))</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
                <span class="n">delete_result</span> <span class="o">=</span> <span class="n">service</span><span class="o">.</span><span class="n">events</span><span class="p">()</span><span class="o">.</span><span class="n">delete</span><span class="p">(</span><span class="n">calendarId</span><span class="o">=</span><span class="s1">'primary'</span><span class="p">,</span> <span class="n">eventId</span><span class="o">=</span><span class="n">event</span><span class="p">[</span><span class="s1">'id'</span><span class="p">])</span><span class="o">.</span><span class="n">execute</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Ignoring </span><span class="si">{</span><span class="n">event</span><span class="p">[</span><span class="s1">'id'</span><span class="p">]</span><span class="si">}</span><span class="s2"> (</span><span class="si">{</span><span class="n">title</span><span class="si">}</span><span class="s2">)"</span><span class="p">)</span>
                <span class="k">continue</span>

    <span class="k">except</span> <span class="n">HttpError</span> <span class="k">as</span> <span class="n">error</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">'An error occurred: </span><span class="si">%s</span><span class="s1">'</span> <span class="o">%</span> <span class="n">error</span><span class="p">)</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
<span class="c1"># [END calendar_quickstart]</span>
</code></pre></div></section><section class="post-footer" style="margin: 12rem 0 0;"><aside class="post-tags"><a href="./tag/python.html">python</a><a href="./tag/googlecalendar.html">googlecalendar</a><a href="./tag/googleapis.html">googleapis</a> </aside><div class="clear"></div><aside class="post-author"><figure class="post-author-avatar"><img alt="Kenneth Bingham" src="https://github.com/qrkourier/qrkourier.github.io/assets/1434400/a8155877-b78a-4ba0-895f-9396777f8b82"/></figure><div class="post-author-bio"><h4 class="post-author-name"><a href="./author/kenneth.html">Kenneth Bingham</a></h4><p class="post-author-about">An American computer engineer living in the United States. </p><span class="post-author-location"><i class="icon icon-location"></i> United States</span><span class="post-author-website"><a href="https://linktr.ee/qrkourier"><i class="icon icon-link"></i> Links</a></span></div><div class="clear"></div></aside></section><aside class="post-nav"><div class="clear"></div></aside></div></article></main><div class="nav-footer"><nav aria-label="Footer" class="nav-wrapper"><span class="nav-copy">hella labs © 2023 </span><span class="nav-credits"><a class="menu-item js-theme" data-dark="Dark theme" data-light="Light theme" data-system="System theme" href="#"><span class="theme-icon"></span><span class="theme-text">System theme</span></a></span></nav></div></section><script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.7.0/highlight.min.js"></script><script src="././js/jquery.fitvids.js" type="text/javascript"></script><script src="././js/script.js" type="text/javascript"></script><script>$(document).ready(function(){var viewport=$(window);var post=$('.post-content');post.fitVids();var mdSelector=".highlight pre";var rstSelector=".highlight pre";var selector=mdSelector;function codestyling(){$(selector).each(function(i,e){hljs.highlightElement(e);if(!$(this).hasClass('language-text')){var code=$(this);var lines=code.html().split(/\n(?!$)/g).length;var numbers=[];if(lines>1){lines++;}
for(i=1;i<lines;i++){numbers+='<span class="line" aria-hidden="true">'+i+'</span>';}
code.parent().append('<div class="lines">'+numbers+'</div>');}});}
function codestylingWithoutLineNumbers(){$(selector).each(function(i,e){hljs.highlightElement(e);});}
codestylingWithoutLineNumbers();function readingProgress(){var postBottom=post.offset().top+post.height();var viewportHeight=viewport.height();var progress=100-(((postBottom-(viewport.scrollTop()+viewportHeight)+viewportHeight/3)/(postBottom-viewportHeight+viewportHeight/3))*100);$('.progress-bar').css('width',progress+'%');(progress>100)?$('.progress-container').addClass('complete'):$('.progress-container').removeClass('complete');}
readingProgress();viewport.on({'scroll':function(){readingProgress();},'resize':function(){readingProgress();},'orientationchange':function(){readingProgress();}});});</script></body></html>