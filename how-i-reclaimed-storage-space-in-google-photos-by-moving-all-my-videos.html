<html><head><script async="" src="https://www.googletagmanager.com/gtag/js?id=G-GLXJ436K7X"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments);}
gtag('js',new Date());gtag('config','G-GLXJ436K7X');</script><meta content="text/html; charset=utf-8" http-equiv="content-type"/><meta content="" name="description"/><meta content="" name="keywords"/><style>@charset "UTF-8";@import url("https://fonts.googleapis.com/css?family=Lato:300,400,900");html,body,div,span,h1,h2,h3,h4,p,a,i,ul,li,article,footer,header,nav,section{margin:0;padding:0;border:0;font-size:100%;font:inherit;vertical-align:baseline}article,footer,header,nav,section{display:block}body{line-height:1}ul{list-style:none}body{-webkit-text-size-adjust:none}*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}body{min-width:1200px}.container{margin-left:auto;margin-right:auto;width:1200px}.\31 1u{width:91.6666666667%}.\34 u{width:33.3333333333%}.row>*{float:left}.row:after{content:'';display:block;clear:both;height:0}.row:first-child>*{padding-top:0 !important}.row>*{padding-left:50px}.row{margin-left:-50px}body{background:#f3f6fa}body.loading *{-moz-animation:none !important;-webkit-animation:none !important;-o-animation:none !important;-ms-animation:none !important;animation:none !important}body{color:#1e2021;font-family:'Lato',sans-serif;font-size:15pt;font-weight:300;letter-spacing:.025em;line-height:1.75em}a{color:#007e6e;text-decoration:none;border-bottom:dotted 1px}p,ul{margin:0 0 2em 0}h1,h2,h3,h4{color:inherit;font-weight:300;line-height:1.75em;margin-bottom:1em;text-transform:uppercase}h2{font-size:1.5em;letter-spacing:.1em}h3{font-size:1.15em;letter-spacing:.025em}section.special{text-align:center}footer>:last-child{margin-bottom:0}::-webkit-input-placeholder{color:inherit;opacity:.5;position:relative;top:3px}:-moz-placeholder{color:inherit;opacity:.5}::-moz-placeholder{color:inherit;opacity:.5}:-ms-input-placeholder{color:inherit;opacity:.5}.icon{position:relative}.icon::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-family:FontAwesome;font-style:normal;font-weight:400}.icon,.feature{display:block;margin:0 0 1.5em 0;opacity:.45;text-align:center}.icon.feature::before{font-size:5em;line-height:1em}ul.buttons:last-child{margin-bottom:0}ul.buttons li{display:inline-block;padding:0 0 0 1.5em}ul.buttons li:first-child{padding:0}ul.buttons.vertical li{display:block;padding:1.5em 0 0 0}ul.buttons.vertical li:first-child{padding:0}.button{background:0;border:solid 1px;color:inherit;display:inline-block;font-size:.8em;font-weight:900;letter-spacing:2px;min-width:18em;padding:.75em 0;text-align:center;text-decoration:none;text-transform:uppercase}.button.fit{width:100%}.button.small{font-size:.7em;min-width:14em;padding:.5em 0}.wrapper{margin-bottom:5em;padding:5em}.wrapper.style1{padding:0}.wrapper.style2{background-color:#997394;background-image:url(../css/images/light-bl.svg),url(../css/images/light-br.svg);background-position:bottom left,bottom right;background-repeat:no-repeat,no-repeat;background-size:25em,25em;color:white}#header{background:white;box-shadow:0 1px 2px 0 rgba(0,0,0,.075);color:inherit;font-size:.8em;left:0;padding:1em 1.5em;position:fixed;top:0;width:100%;z-index:10000}#header h1{font-weight:900;margin:0}#header nav{letter-spacing:.075em;position:absolute;right:1.5em;text-transform:uppercase;top:.75em}#header nav ul li{display:inline-block;margin-left:1.5em}#header nav ul li>ul{display:none}#header nav ul li a{border:solid 1px transparent;color:inherit;display:inline-block;padding:0 .75em;text-decoration:none}#header nav ul li.submenu>a::before{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;font-style:normal;font-weight:400;margin-right:.65em}#header nav ul li.current>a{font-weight:900}#header.alt{-moz-animation:none;-webkit-animation:none;-o-animation:none;-ms-animation:none;animation:none;background:transparent;box-shadow:none;color:white;padding:2em 2.5em;position:absolute}#header.alt nav{right:2.5em;top:1.75em}@-moz-keyframes reveal-banner{0%{opacity:0}100%{opacity:1}}@-webkit-keyframes reveal-banner{0%{opacity:0}100%{opacity:1}}@-o-keyframes reveal-banner{0%{opacity:0}100%{opacity:1}}@-ms-keyframes reveal-banner{0%{opacity:0}100%{opacity:1}}@keyframes reveal-banner{0%{opacity:0}100%{opacity:1}}#banner{background-attachment:scroll,scroll,scroll,fixed;background-color:#945862;background-image:url(../images/robobanner.jpg);background-position:center;background-repeat:no-repeat,no-repeat,repeat,no-repeat;background-size:cover;color:white;padding:6em 0;text-align:center}#banner .inner{-moz-animation:reveal-banner 1s .25s ease-in-out;-webkit-animation:reveal-banner 1s .25s ease-in-out;-o-animation:reveal-banner 1s .25s ease-in-out;-ms-animation:reveal-banner 1s .25s ease-in-out;animation:reveal-banner 1s .25s ease-in-out;-moz-animation-fill-mode:forwards;-webkit-animation-fill-mode:forwards;-o-animation-fill-mode:forwards;-ms-animation-fill-mode:forwards;animation-fill-mode:forwards;background:rgba(52,27,43,.5);color:white;display:inline-block;opacity:0;padding:3em;text-align:center}#banner .inner header{display:inline-block;border-bottom:solid 2px;border-top:solid 2px;margin:0 0 2em 0;padding:3px 0 3px 0}#banner .inner header h2{border-bottom:solid 2px;border-top:solid 2px;font-size:2.5em;font-weight:900;letter-spacing:.2em;margin:0;padding-left:.05em;position:relative;text-transform:uppercase}#banner .inner p{letter-spacing:.1em;margin:0;text-transform:uppercase}#banner .inner footer{margin:2em 0 0 0}#main{background-image:url(../css/images/dark-tl.svg),url(../css/images/dark-tr.svg),url(../css/images/dark-bl.svg),url(../css/images/dark-br.svg);background-position:top left,top right,bottom left,bottom right;background-repeat:no-repeat;background-size:25em;padding:7em 0}#main>:last-child{margin-bottom:0}body.index #main{padding-top:5em}#banner .inner{opacity:1}.fab,.fas{-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;display:inline-block;font-style:normal;font-variant:normal;text-rendering:auto;line-height:1}.fa-5x{font-size:5em}.fa-angle-down:before{content:"\f107"}.fa-aws:before{content:"\f375"}.fa-cloud:before{content:"\f0c2"}.fa-fly:before{content:"\f417"}.fab{font-family:Font Awesome\ 5 Brands}.fas{font-family:Font Awesome\ 5 Free}.fas{font-weight:900}</style><link href="./feeds/all.atom.xml" rel="alternate" title="hella labs-Feed" type="application/atom+xml"/><title>How I Reclaimed Storage Space in Google Photos By Moving All My Videos | hella labs</title><meta charset="utf-8"/><meta content="width=device-width" name="viewport"/></head><body class="loading"><header id="header"><h1 class="logo"><br/></h1><nav id="nav"><ul><li class="current"><a href="/index.html">Welcome</a></li><li><a href="./pages/about.html">About</a></li><li><a href="./pages/projects.html">Projects</a></li><li class="submenu"><span class="fas fa-angle-down"></span><a href="./">blog</a><ul><li class="active"><a href="./category/tech.html">tech</a></li></ul></li></ul></nav></header><article id="main"><header class="special container"><span class="icon"><span class="fas fa-video-slash fa-5x"></span></span><h2><a href="how-i-reclaimed-storage-space-in-google-photos-by-moving-all-my-videos.html">How I Reclaimed Storage Space in Google Photos By Moving All My Videos</a></h2><p class="tags"><a href="./tag/python.html">#python  </a><a href="./tag/backup.html">#backup  </a><a href="./tag/rclone.html">#rclone  </a> in <a href="./category/tech.html">tech</a></p><p>updated Fri 22 September 2023 by Ken</p></header><section class="wrapper style4 container"><div class="content"><section><p><p>There's no easy way to find and delete a particular file or type of file in Google Photos, and there's no way to bulk delete with a tool or even the API. Here's a simple tool chain that answered my need to move all videos out to reclaim storage space.</p><div class="toc"><span class="toctitle">Table of contents:</span><ul><li><a href="#sync-photos-and-videos">Sync Photos and Videos</a></li><li><a href="#move-videos">Move Videos</a></li><li><a href="#delete-all-videos-from-google-photos">Delete All Videos From Google Photos</a></li><li><a href="#replicated-videos-to-new-storage">Replicated Videos to New Storage</a></li></ul></div><p>Google Photos has some unique talents. I find it useful for exploring my own archives with the built-in machine learning features like "pictures from Ashland" or "red car". The balance of value is less favorable for videos, and they were the only reason I was paying for 2TB of cloud storage, so I decided to prune them out of my Google Photos account.</p><p>Problem: there's no easy way to do that! Even the API doesn't have a delete operation. I can find them easily enough in the app by searching "videos", and I can painstakingly download them and delete them, but I'd prefer to express this as code, if possible.</p><h2 id="sync-photos-and-videos">Sync Photos and Videos</h2><p>I found <code>gphotos-sync</code>, a handy implementation of the Google Photos API that creates a local replica of the entire library with albums and other metadata that I didn't need. Still, supremely useful to make sure I have a copy of all videos.</p><h2 id="move-videos">Move Videos</h2><p>I wrote a tiny Python program to to move my videos out of the gphotos-sync directory.</p><ol><li>walk the gphotos-sync photos directory</li><li>detect if a file is a video MIME type</li><li>move the videos to a new folder</li></ol><div class="highlight"><pre><span></span><code>❯<span class="w"> </span>python<span class="w"> </span>./move_videos.py
Moving:<span class="w"> </span>./2017/02/2017-02-15-they-sang.mp4<span class="w"> </span><span class="m">787</span>.8MiB<span class="w"> </span>-&gt;<span class="w"> </span>./Videos/videos_from_gphotos/2017/02/2017-02-15-they-sang.mp4
Moving:<span class="w"> </span>./2003/04/or-portland-roofing_residence.3gp<span class="w"> </span><span class="m">849</span>.1KiB<span class="w"> </span>-&gt;<span class="w"> </span>./Videos/videos_from_gphotos/2003/04/or-portland-roofing_residence.3gp
Moving:<span class="w"> </span>./2003/02/or-ashland-alex_and_ax_blowin_in_the_wind.3gp<span class="w"> </span><span class="m">1</span>.0MiB<span class="w"> </span>-&gt;<span class="w"> </span>./Videos/videos_from_gphotos/1973/02/or-ashland-alex_and_ax_blowin_in_the_wind.3gp
Total:<span class="w"> </span><span class="m">58</span>.7GiB
</code></pre></div><div class="highlight"><pre><span></span><code><span class="kn">import</span> <span class="nn">filetype</span>
<span class="kn">from</span> <span class="nn">os.path</span> <span class="kn">import</span> <span class="n">join</span><span class="p">,</span> <span class="n">getsize</span><span class="p">,</span> <span class="n">dirname</span>
<span class="kn">from</span> <span class="nn">os</span> <span class="kn">import</span> <span class="n">walk</span><span class="p">,</span> <span class="n">chdir</span>
<span class="kn">from</span> <span class="nn">shutil</span> <span class="kn">import</span> <span class="n">move</span>
<span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>

<span class="c1"># move_videos.py moves files with a video MIME type to a different top-level directory with the same directory structure</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="c1"># The top argument for walk</span>
    <span class="n">topdir</span> <span class="o">=</span> <span class="s1">'./Downloads/from_gphotos/photos'</span>
    <span class="n">dest_topdir</span> <span class="o">=</span> <span class="s1">'./Videos/videos_from_gphotos'</span>
    <span class="n">chdir</span><span class="p">(</span><span class="n">topdir</span><span class="p">)</span>

    <span class="n">total_bytes</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">root</span><span class="p">,</span> <span class="n">dirs</span><span class="p">,</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">walk</span><span class="p">(</span><span class="s1">'.'</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">files</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">Path</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span><span class="o">.</span><span class="n">is_symlink</span><span class="p">():</span>
                <span class="k">continue</span>
            <span class="k">elif</span> <span class="n">filetype</span><span class="o">.</span><span class="n">is_video</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">)):</span>
                <span class="n">size</span> <span class="o">=</span> <span class="n">getsize</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">))</span>
                <span class="n">total_bytes</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">total_bytes</span>
                <span class="n">dest</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">dest_topdir</span><span class="p">,</span> <span class="n">root</span><span class="o">.</span><span class="n">strip</span><span class="p">(</span><span class="s1">'./'</span><span class="p">),</span> <span class="n">name</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">"Moving:"</span><span class="p">,</span> <span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">sizeof_fmt</span><span class="p">(</span><span class="n">size</span><span class="p">),</span> <span class="s2">"-&gt;"</span><span class="p">,</span> <span class="n">dest</span><span class="p">)</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">parent</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">dirname</span><span class="p">(</span><span class="n">dest</span><span class="p">))</span>
                    <span class="n">parent</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">move</span><span class="p">(</span><span class="n">join</span><span class="p">(</span><span class="n">root</span><span class="p">,</span> <span class="n">name</span><span class="p">),</span> <span class="n">dest</span><span class="p">)</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">raise</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">"Total:"</span><span class="p">,</span> <span class="n">sizeof_fmt</span><span class="p">(</span><span class="n">total_bytes</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">sizeof_fmt</span><span class="p">(</span><span class="n">num</span><span class="p">,</span> <span class="n">suffix</span><span class="o">=</span><span class="s2">"B"</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">unit</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">""</span><span class="p">,</span> <span class="s2">"Ki"</span><span class="p">,</span> <span class="s2">"Mi"</span><span class="p">,</span> <span class="s2">"Gi"</span><span class="p">,</span> <span class="s2">"Ti"</span><span class="p">,</span> <span class="s2">"Pi"</span><span class="p">,</span> <span class="s2">"Ei"</span><span class="p">,</span> <span class="s2">"Zi"</span><span class="p">]:</span>
        <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">num</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1024.0</span><span class="p">:</span>
            <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">3.1f</span><span class="si">}{</span><span class="n">unit</span><span class="si">}{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">"</span>
        <span class="n">num</span> <span class="o">/=</span> <span class="mf">1024.0</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="n">num</span><span class="si">:</span><span class="s2">.1f</span><span class="si">}</span><span class="s2">Yi</span><span class="si">{</span><span class="n">suffix</span><span class="si">}</span><span class="s2">"</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div><h2 id="delete-all-videos-from-google-photos">Delete All Videos From Google Photos</h2><p>There's a simple trick to do this in a fell swoop.</p><ol><li>search "videos" and make sure the results are all videos</li><li>tick the select box on the first result</li><li>scroll down to the bottom of results</li><li>hold SHIFT and left-click the last result</li><li>click the trash button or press <code>#</code> to delete</li></ol><p>As of this writing the videos would be in Trash for 60 days before they're permanently deleted and the available storage returned to you.</p><h2 id="replicated-videos-to-new-storage">Replicated Videos to New Storage</h2><p>I still need to keep a copy of my videos off-site in case something happens to my storage at home or I lose access for some reason. I didn't want to keep track of copying the files so it needs to be an automated sync.</p><p>I chose <code>rclone</code> which is a versatile sync tool for cloud storage. It works with S3-compliant APIs, and I found STORJ has a very cheap option and as a bonus it is a form decentralized storage with an open-source bent. Cool.</p><ol><li>I signed up for Storj's free 150GB option and added about 20 USD worth of STORJ tokens to my account to cover future overages. No credit card required. </li><li>I followed <a href="https://docs.storj.io/dcs/how-tos/sync-files-with-rclone/rclone-with-native-integration/">Storj's own guide</a> for configuring <code>rclone</code>.</li><li>I added a sync command to my backup script:</li></ol><div class="highlight"><pre><span></span><code>rclone<span class="w"> </span>sync<span class="w"> </span>~/Videos/<span class="w"> </span>storj:videos/
</code></pre></div></p></section></div></section><section class="wrapper style1 container special"><div class="row"><div class="4u"><section><span class="icon feature"><span class="fas fa-cloud fa-5x"></span></span><header><a href="./cloudflare-dns-for-network-manager.html" rel="bookmark"><h3>CloudFlare DNS for Network Manager</h3></a></header><p>CloudFlare provides a performant recursive nameserver along with a promise to never surv</p><footer><ul class="buttons"><li><a class="button small" href="./cloudflare-dns-for-network-manager.html">Read More</a></li></ul></footer></section></div><div class="4u"><section><span class="icon feature"><span class="fab fa-fly fa-5x"></span></span><header><a href="./flyio-programmable-front-end.html" rel="bookmark"><h3>Fly.io Programmable Front-end</h3></a></header><p>In short, a programmable cloud delivery network (CDN) aka front-end like Fly.io is an API by which to configure the logical edge of an application stack. Fly.io</p><footer><ul class="buttons"><li><a class="button small" href="./flyio-programmable-front-end.html">Read More</a></li></ul></footer></section></div><div class="4u"><section><span class="icon feature"><span class="fas fa-video-slash fa-5x"></span></span><header><a href="./how-i-reclaimed-storage-space-in-google-photos-by-moving-all-my-videos.html" rel="bookmark"><h3>How I Reclaimed Storage Space in Google Photos By Moving All My Videos</h3></a></header><p>There's no easy way to find and delete a particular file or type of file in Google Photos, and there's no way to bulk delete with a tool or even the API. Here's</p><footer><ul class="buttons"><li><a class="button small" href="./how-i-reclaimed-storage-space-in-google-photos-by-moving-all-my-videos.html">Read More</a></li></ul></footer></section></div></div></section></article><footer id="footer"><ul class="icons"></ul><span class="copyright">This work is licensed under a <a href="http://creativecommons.org/licenses/by/3.0/" rel="license">Creative Commons Attribution 3.0 Unported License</a>. <br/> Design: <a href="http://html5up.net">HTML5 UP</a>.</span></footer><!--[if lte IE 8]><script src="css/ie/html5shiv.js"></script><![endif]--><script src="/js/packed.js?9153b101"></script><link href="/css/pygment.css" rel="stylesheet"/><noscript><link href="/css/skel.css" rel="stylesheet"/><link href="/css/style.css" rel="stylesheet"/><link href="/css/style-noscript.css" rel="stylesheet"/></noscript><script src="//cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script><link crossorigin="anonymous" href="https://use.fontawesome.com/releases/v6.4.0/css/all.css" rel="stylesheet"/><link href="https://fonts.googleapis.com/css?family=Anonymous+Pro:regular,italic,bold,bolditalic" rel="stylesheet" type="text/css"/><!--[if lte IE 8]><link rel="stylesheet" href="/css/ie/v8.css" /><![endif]--><!--[if lte IE 9]><link rel="stylesheet" href="/css/ie/v9.css" /><![endif]--></body></html>